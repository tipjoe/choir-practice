<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="Cache-Control" content="no-store" />
    <title>Take a Chancel!</title>
    <link rel="stylesheet" type="text/css" href="./assets/songs.css" />
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"
    ></script>
    <script src="./assets/songs.js" type="text/javascript"></script>
  </head>
  <body>
    <h1 class="center">Choir Song Practice</h1>
    <h3>How This Works</h3>
    <ul class="bigger">
      <li>Click a song to listen</li>
      <li>Use <button>+</button> to count listens</li>
      <li>Use <button>Got It!</button> when you <i>think you know it</i></li>
      <li>Then <button>Give It!</button> to start to <i>really know it</i></li>
      <li>
        The song will tell you how!
        <ul>
          <li>Do something nice</li>
          <li>Listen to someone</li>
          <li>Learn something</li>
          <li>Share something</li>
          <li>Whatever good thing the song inspires</li>
        </ul>
      </li>
    </ul>
    <p>
      We don't really <button>Got It!</button> until we
      <button>Give It!</button>, which is <button>Good!</button>.
    </p>
    <div style="margin-top: 24px">
      <h3>Upcoming Songs</h3>
      See list of <a href="#past-songs">Past Songs</a> we've performed.
      <br /><br />
      <table id="table-song">
        <thead>
          <th colspan="2" style="width: 65%">Listen Links</th>
          <th style="width: 35%">Performing</th>
        </thead>
        <tbody x-data>
          <template x-for="song in Alpine.store('choir')?.getSongs()">
            <tr>
              <td class="song-thumb">
                <a x-bind:href="song.url" target="_blank">
                  <img x-bind:src="song.thumb" class="thumb" />
                </a>
              </td>
              <td class="song-link-track">
                <div>
                  <div>
                    <button
                      class="inc-button"
                      x-bind:id="'incButton' + song.id"
                      x-on:click="Alpine.store('choir').incrementListenCount(event)"
                    >
                      +
                    </button>
                    <span
                      class="count-label"
                      x-text:="Alpine.store('choir').getListenCountById(song.id)"
                    ></span>
                  </div>
                  <div>
                    <button
                      class="got-it-button"
                      x-bind:id="'gotItButton' + song.id"
                      x-bind:disabled="Alpine.store('choir').isGood(song.id)"
                      x-on:click="Alpine.store('choir').toggleGotIt(song.id)"
                    >
                      <span
                        x-text="Alpine.store('choir').gotItLabel(song.id)"
                      ></span>
                    </button>
                  </div>

                  <a x-bind:href="song.url" target="_blank">
                    <span x-text="song.title"></span>
                  </a>
                </div>
              </td>
              <td
                :class="Alpine.store('choir').daysFromNowClass(song.id)"
                style="text-align: center"
              >
                <span x-text="formatDate(new Date(song.due))"></span>
                <br /><br />
                <span
                  x-text="'(in ' + daysFromNow(new Date(song.due)) +  ' days)'"
                ></span>
              </td>
            </tr>
          </template>
        </tbody>
      </table>
    </div>

    <div
      x-data
      x-show="Alpine.store('choir')?.getPastSongs().length"
      style="margin-top: 24px"
    >
      <h3 id="past-songs">
        Past Songs (<span
          x-text="Alpine.store('choir')?.getPastSongs().length"
        ></span
        >)
      </h3>
      <table id="table-song">
        <thead>
          <th colspan="2" style="width: 65%">Listen Links</th>
          <th style="width: 35%">Performed</th>
        </thead>
        <tbody x-data>
          <template x-for="song in Alpine.store('choir')?.getPastSongs()">
            <tr>
              <td class="song-thumb">
                <a x-bind:href="song.url" target="_blank">
                  <img x-bind:src="song.thumb" class="thumb" />
                </a>
              </td>
              <td class="song-link-track2">
                <div>
                  <div
                    x-show="!!Alpine.store('choir').getListenCountById('countLabel' + song.id)"
                  >
                    Listened
                    <span
                      x-text:="Alpine.store('choir').getListenCountById(song.id)"
                    ></span>
                    times
                  </div>

                  <a x-bind:href="song.url" target="_blank">
                    <span x-text="song.title"></span>
                  </a>
                </div>
              </td>
              <td style="text-align: center">
                <span x-text="formatDate(new Date(song.due))"></span>
              </td>
            </tr>
          </template>
        </tbody>
      </table>
    </div>
  </body>
</html>
