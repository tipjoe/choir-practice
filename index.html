<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="Cache-Control" content="no-store" />
    <title>Choir Song Practice</title>
    <link rel="stylesheet" type="text/css" href="./assets/songs.css" />
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"
    ></script>
    <script src="./assets/songs.js" type="text/javascript"></script>
  </head>
  <body>
    <h1 class="center">Choir Song Practice</h1>
    Click to listen. Songs ordered 1) by schedule, 2) then alphabetical if
    not yet scheduled.

    <div style="margin-top: 36px">
      <h3>Upcoming Songs</h3>
      <span
        x-data
        x-show="Alpine.store('choir')?.getPastSongs().length"
        style="color: gray; font-size: 0.8em"
      >
        See <a href="#past-songs">Past Songs</a> we've performed. <br /><br />
      </span>
      <table id="table-song">
        <thead>
          <th colspan="2" style="width: 65%">Listen Links</th>
          <th style="width: 35%">Performing</th>
        </thead>
        <tbody x-data>
          <template x-for="song in Alpine.store('choir')?.getSongs()">
            <tr x-bind:id="song.id" >
              <td class="song-thumb">
                <a x-bind:href="song.url" target="_blank">
                  <img x-bind:src="song.thumb" class="thumb" />
                </a>
              </td>
              <td class="song-link-track">
                <a class="anchor-link" x-bind:href="'#' + song.id">ðŸ”—</a>
                <a x-bind:href="song.url" target="_blank">
                  <span x-text="song.title"></span>
                </a>
            </td>
              <td
                :class="Alpine.store('choir').daysFromNowClass(song.id)"
                style="text-align: center"
              >
                <div>
                  <div x-show="new Date(song.due).getTime() === new Date('1/1/2099').getTime()">
                    Not yet scheduled
                  </div>
                  <div x-show="new Date(song.due).getTime() !== new Date('1/1/2099').getTime()">
                    <span x-text="formatDate(new Date(song.due))"></span>
                    <br /><br />
                    <span style="font-size: .8em" x-text="'(in ' + daysFromNow(new Date(song.due)) +  ' days)'"></span>
                  </div>
                </div>
              </td>
            </tr>
          </template>
        </tbody>
      </table>
    </div>

    <div
      x-data
      x-show="Alpine.store('choir')?.getPastSongs().length"
      style="margin-top: 96px"
    >
      <h3 id="past-songs">
        Past Songs (<span
          x-text="Alpine.store('choir')?.getPastSongs().length"
        ></span
        >)
      </h3>
      <table id="table-song">
        <thead>
          <th colspan="2" style="width: 65%">Listen Links</th>
          <th style="width: 35%">Performed</th>
        </thead>
        <tbody x-data>
          <template x-for="song in Alpine.store('choir')?.getPastSongs()">
            <tr>
              <td class="song-thumb">
                <a x-bind:href="song.url" target="_blank">
                  <img x-bind:src="song.thumb" class="thumb" />
                </a>
              </td>
              <td class="song-link-track2">
                <div>
                  <div
                    x-show="!!Alpine.store('choir').getListenCountById('countLabel' + song.id)"
                  >
                    Listened
                    <span
                      x-text:="Alpine.store('choir').getListenCountById(song.id)"
                    ></span>
                    times
                  </div>

                  <a x-bind:href="song.url" target="_blank">
                    <span x-text="song.title"></span>
                  </a>
                </div>
              </td>
              <td style="text-align: center">
                <span x-text="formatDate(new Date(song.due))"></span>
              </td>
            </tr>
          </template>
        </tbody>
      </table>
    </div>
  </body>
</html>
